# User Stories for Gateway Admin Frontend & Backend

## 说明
- 本文档将需求拆解为适合3位初级开发工程师的User Stories，每个故事建议用时2-3天。
- 包含前端、后端、权限、搜索、数据管理等全流程。
- 每个故事包含目标、主要任务、验收标准。

---

## Story 1：基础页面与多语言切换
**目标**：实现主页面结构、Tab分区、右上角语言切换、全局表单配置API对接。

- 实现主页面AppBar（Logo、项目名、语言切换下拉框）。
- 实现多Tab分区（Basic、Backends、Cookies、Headers、Response Body Decorator、Limiters）。
- 实现全局Context，支持表单配置和语言切换。
- 页面加载时自动请求REST API获取所有表单配置和多语言label。
- 切换语言后所有label和选项即时切换。

**验收标准**：
- 页面结构美观，切换Tab无滚动。
- 切换语言后所有表单label/选项即时切换。
- 所有表单项的label、选项、校验规则均来自API。

---

## Story 2：数据列表与搜索筛选
**目标**：实现网关映射配置的数据列表页，支持关键字、域名等多条件搜索与筛选。

- 前端实现数据列表页，展示所有网关映射配置（分页）。
- 支持按关键字、域名、项目名等字段快速搜索。
- 支持按状态（启用/禁用）、所属项目等筛选。
- 搜索/筛选条件与URL参数联动，便于分享和回溯。
- 后端API支持分页、模糊搜索、条件筛选。

**验收标准**：
- 用户可通过关键字、域名等快速定位目标配置。
- 切换筛选条件、翻页、刷新后结果一致。
- 后端API返回数据准确，性能良好。

---

## Story 3：权限与访问控制（前端）
**目标**：根据用户权限动态控制页面可见性、可编辑性、可删除性。

- 登录后根据用户角色/权限（如admin、editor、viewer）动态渲染页面内容。
- 只读用户仅能查看数据，不能编辑/删除/新建。
- 编辑用户可修改、保存数据，但不能删除。
- 管理员可新建、编辑、删除所有数据。
- 无权限用户访问受限页面时显示无权限提示。
- 前端所有操作按钮（编辑、删除、保存）根据权限动态显示/禁用。

**验收标准**：
- 不同权限用户登录后页面内容、操作按钮完全不同。
- 无权限操作时有明确提示。

---

## Story 4：权限与访问控制（后端）
**目标**：后端API根据用户身份和权限校验所有操作，防止越权。

- 后端所有API接口需校验用户身份和权限。
- 只读用户API仅返回可见数据，禁止POST/PUT/DELETE。
- 编辑用户API允许PUT/POST，禁止DELETE。
- 管理员API允许所有操作。
- 无权限用户API直接返回403。
- 后端日志记录所有敏感操作。

**验收标准**：
- 任意用户无法通过API越权操作。
- 日志可追溯所有敏感操作。

---

## Story 5：BasicTab与表单校验
**目标**：实现BasicTab表单，支持域名、路径、CMDB项目选择，前端校验。

- 实现BasicTab表单，字段包括：Domain、Request Path Pattern、Backend Forward Path、CMDB Project。
- 所有字段必填，域名+路径唯一性校验（前端提示）。
- CMDB项目下拉选项从API获取。
- 表单项与全局formData context同步。
- 只读用户禁用所有输入项。

**验收标准**：
- BasicTab所有字段可填写、可选，校验生效。
- 校验不通过时有明确提示。
- 只读用户无法编辑。

---

## Story 6：BackendsTab（目标服务器）
**目标**：实现后端目标服务器的增删、详细信息填写、Proxy设置、UI美化。

- 支持添加/删除多个后端目标服务器。
- 每个目标服务器字段：Hostname、Port、Protocol、Region、Data Center、Enable、Rewrite Host、Web Proxy设置（含Proxy Host/Port/Username/Password）。
- Proxy设置启用时显示相关输入框。
- 每行1-2项，分组明显，UI宽松美观。
- 所有输入项与formData context同步。
- 只读用户禁用所有输入项和按钮。

**验收标准**：
- 可动态增删目标服务器，所有字段可填写。
- Proxy设置交互友好，UI分组明显。
- 只读用户无法编辑。

---

## Story 7：CookiesTab（Cookie策略）
**目标**：实现全局Cookie策略、例外Cookie的增删、格式校验、模糊匹配。

- 支持选择全局Cookie策略（下拉）。
- 支持添加/删除Excluded Cookie，输入时校验RFC6265。
- 每个Excluded Cookie支持Started With（模糊匹配）checkbox。
- 所有输入项与formData context同步。
- 只读用户禁用所有输入项和按钮。

**验收标准**：
- 可动态增删Excluded Cookie，校验生效。
- 只读用户无法编辑。

---

## Story 8：HeadersTab（请求/响应Header）
**目标**：实现请求/响应Header的增删、覆盖选项、UI美化。

- 支持添加/删除多个Request Header和Response Header。
- 每个Header字段：Name、Value、Override（checkbox）。
- 所有输入项与formData context同步。
- 只读用户禁用所有输入项和按钮。

**验收标准**：
- 可动态增删Header，所有字段可填写。
- 只读用户无法编辑。

---

## Story 9：Response Body Decorator（错误页映射）
**目标**：实现错误码与自定义页面路径的映射、格式校验、增删。

- 支持添加/删除多个Error Page Mapping。
- Status Code为数字，Page Path需为URI Path或完整URL，前端校验。
- 所有输入项与formData context同步。
- 只读用户禁用所有输入项和按钮。

**验收标准**：
- 可动态增删映射，校验生效。
- 只读用户无法编辑。

---

## Story 10：LimitersTab（访问限制）
**目标**：实现IP/CIDR规则、并发/频率限制、方法选择、格式校验。

- 支持添加/删除多个IP/CIDR规则，输入时校验IPv4或IPv4/CIDR。
- 支持配置最大并发、每分钟调用数、允许方法（多选checkbox）。
- 所有输入项与formData context同步。
- 只读用户禁用所有输入项和按钮。

**验收标准**：
- 可动态增删IP规则，所有限制项可填写。
- 校验生效，切换语言后label/选项同步切换。
- 只读用户无法编辑。

---

## Story 11：表单提交、编辑、删除与确认
**目标**：实现全局表单数据收集、提交、编辑、删除、弹窗确认、结果提示。

- Tab下方有提交、保存、删除按钮（按权限显示）。
- 点击后弹窗展示所有表单内容详情，用户确认后POST/PUT/DELETE到API。
- 提交成功/失败有明确提示。
- 只读用户无提交、保存、删除按钮。
- 后端API支持新建、编辑、删除、只读、权限校验。

**验收标准**：
- 所有Tab数据能被完整收集和提交。
- 弹窗内容美观，结果提示清晰。
- 权限校验严格。

---

## Story 12：整体UI美化与可用性提升
**目标**：提升整体UI的商业化、易用性和响应式体验。

- 所有表单、按钮、弹窗、分组等采用MUI最佳实践美化。
- 重要说明用Alert，分组用Divider，小标题加粗。
- 响应式布局，适配不同屏幕。
- 只读、禁用、不可见等状态有明显视觉区分。

**验收标准**：
- UI风格统一现代，操作区分明，移动端体验良好。
- 权限状态下UI反馈清晰。

---

> 建议3位开发者可按Tab/功能/权限/搜索分工，每人每次领取1-2个User Story，2-3天内完成并自测。
> 后端开发需与前端协作，确保API、权限、日志、搜索等功能完整。 